/Users/shuaif/miniforge3/envs/py38/bin/python /Users/shuaif/PycharmProjects/ood_flow_detection/contrast_learning/main_ce_baseline.py --epoch 50 --model CNN --batch_size 128 --n_data_train 260000 --activation relu
Namespace(activation='relu', batch_size=128, data='moore', draw_figures=False, epoch=50, lr=0.0001, model='CNN', n_data_train=260000, projection_dim=128, write_summary=False)
Loading moore data...
(268611, 256) (89538, 256)
Training dataset shapes after slicing:
(260000, 256, 1) (260000,)
/Users/shuaif/miniforge3/envs/py38/lib/python3.8/site-packages/keras/backend.py:5585: UserWarning: "`sparse_categorical_crossentropy` received `from_logits=True`, but the `output` argument was produced by a Softmax activation and thus does not represent logits. Was this intended?
  output, from_logits = _get_logits(
2023-03-16 12:06:17.046406: W tensorflow/tsl/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz
Epoch 1, Loss: 0.3296802043914795, Acc: 91.23999786376953, Test Loss: 0.17410436272621155, Test Acc: 94.94515991210938
Epoch 2, Loss: 0.1481281965970993, Acc: 95.81346130371094, Test Loss: 0.11904893815517426, Test Acc: 96.79242706298828
Epoch 3, Loss: 0.11283640563488007, Acc: 96.8423080444336, Test Loss: 0.09578472375869751, Test Acc: 97.39105224609375
Epoch 4, Loss: 0.09440570324659348, Acc: 97.32115173339844, Test Loss: 0.08082157373428345, Test Acc: 97.67137908935547
Epoch 5, Loss: 0.08385512232780457, Acc: 97.66730499267578, Test Loss: 0.07280657440423965, Test Acc: 98.02318572998047
Epoch 6, Loss: 0.07679031044244766, Acc: 97.84500122070312, Test Loss: 0.06754450500011444, Test Acc: 97.98856353759766
Epoch 7, Loss: 0.0713866651058197, Acc: 97.99922943115234, Test Loss: 0.061727866530418396, Test Acc: 98.34260559082031
Epoch 8, Loss: 0.06676511466503143, Acc: 98.13692474365234, Test Loss: 0.05776773765683174, Test Acc: 98.55145263671875
Epoch 9, Loss: 0.06320694833993912, Acc: 98.24846649169922, Test Loss: 0.05535944178700447, Test Acc: 98.61399841308594
Epoch 10, Loss: 0.05964425951242447, Acc: 98.33731079101562, Test Loss: 0.05190079286694527, Test Acc: 98.62293243408203
Epoch 11, Loss: 0.05778612941503525, Acc: 98.42961120605469, Test Loss: 0.04935377463698387, Test Acc: 98.82508087158203
Epoch 12, Loss: 0.0551479198038578, Acc: 98.48307800292969, Test Loss: 0.047705650329589844, Test Acc: 98.88426971435547
Epoch 13, Loss: 0.05353116616606712, Acc: 98.56230926513672, Test Loss: 0.04641158878803253, Test Acc: 98.90996551513672
Epoch 14, Loss: 0.05124271288514137, Acc: 98.62769317626953, Test Loss: 0.04433280602097511, Test Acc: 98.936767578125
Epoch 15, Loss: 0.04986872524023056, Acc: 98.67384338378906, Test Loss: 0.04271116852760315, Test Acc: 99.0328140258789
Epoch 16, Loss: 0.048554908484220505, Acc: 98.72038269042969, Test Loss: 0.04116912931203842, Test Acc: 99.0104751586914
Epoch 17, Loss: 0.04704912379384041, Acc: 98.75846099853516, Test Loss: 0.03992683067917824, Test Acc: 99.10094451904297
Epoch 18, Loss: 0.045291874557733536, Acc: 98.83077239990234, Test Loss: 0.039155151695013046, Test Acc: 99.08418273925781
Epoch 19, Loss: 0.04402035102248192, Acc: 98.83846282958984, Test Loss: 0.03992407023906708, Test Acc: 99.06072998046875
Epoch 20, Loss: 0.04326320439577103, Acc: 98.87846374511719, Test Loss: 0.03741956502199173, Test Acc: 99.12327575683594
Epoch 21, Loss: 0.04226530343294144, Acc: 98.90692138671875, Test Loss: 0.037682194262742996, Test Acc: 99.08977508544922
Epoch 22, Loss: 0.041732918471097946, Acc: 98.90846252441406, Test Loss: 0.03520091623067856, Test Acc: 99.19252014160156
Epoch 23, Loss: 0.04080936685204506, Acc: 98.94192504882812, Test Loss: 0.03557031229138374, Test Acc: 99.1556625366211
Epoch 24, Loss: 0.04000740125775337, Acc: 98.94538879394531, Test Loss: 0.035608235746622086, Test Acc: 99.19810485839844
Epoch 25, Loss: 0.03935372456908226, Acc: 98.98307800292969, Test Loss: 0.0348559245467186, Test Acc: 99.21709442138672
Epoch 26, Loss: 0.03877188265323639, Acc: 99.00192260742188, Test Loss: 0.033833254128694534, Test Acc: 99.2528305053711
Epoch 27, Loss: 0.038346461951732635, Acc: 99.02153778076172, Test Loss: 0.03421331197023392, Test Acc: 99.16683197021484
Epoch 28, Loss: 0.0373886376619339, Acc: 99.02769470214844, Test Loss: 0.03253306448459625, Test Acc: 99.2751693725586
Epoch 29, Loss: 0.03727131709456444, Acc: 99.028076171875, Test Loss: 0.0320003367960453, Test Acc: 99.23831176757812
Epoch 30, Loss: 0.03650546818971634, Acc: 99.0642318725586, Test Loss: 0.03302479162812233, Test Acc: 99.21932983398438
Epoch 31, Loss: 0.03589369356632233, Acc: 99.09076690673828, Test Loss: 0.032076384872198105, Test Acc: 99.25952911376953
Epoch 32, Loss: 0.035919494926929474, Acc: 99.08999633789062, Test Loss: 0.03098914586007595, Test Acc: 99.30755615234375
Epoch 33, Loss: 0.03520394116640091, Acc: 99.10384368896484, Test Loss: 0.031003456562757492, Test Acc: 99.28521728515625
Epoch 34, Loss: 0.034777238965034485, Acc: 99.1015396118164, Test Loss: 0.03038615919649601, Test Acc: 99.2751693725586
Epoch 35, Loss: 0.034350745379924774, Acc: 99.13884735107422, Test Loss: 0.03087727725505829, Test Acc: 99.28633880615234
Epoch 36, Loss: 0.03403697907924652, Acc: 99.14614868164062, Test Loss: 0.030336368829011917, Test Acc: 99.30197143554688
Epoch 37, Loss: 0.033686477690935135, Acc: 99.13538360595703, Test Loss: 0.031028294935822487, Test Acc: 99.31426239013672
Epoch 38, Loss: 0.0332978293299675, Acc: 99.14691925048828, Test Loss: 0.02999226376414299, Test Acc: 99.30197143554688
Epoch 39, Loss: 0.03305750712752342, Acc: 99.16192626953125, Test Loss: 0.029705192893743515, Test Acc: 99.31761169433594
Epoch 40, Loss: 0.03239355981349945, Acc: 99.1500015258789, Test Loss: 0.028903789818286896, Test Acc: 99.35111236572266
Epoch 41, Loss: 0.03250239044427872, Acc: 99.1611557006836, Test Loss: 0.028533240780234337, Test Acc: 99.341064453125
Epoch 42, Loss: 0.03210096061229706, Acc: 99.18384552001953, Test Loss: 0.02933684177696705, Test Acc: 99.3321304321289
Epoch 43, Loss: 0.03190186992287636, Acc: 99.16384887695312, Test Loss: 0.02888571098446846, Test Acc: 99.30197143554688
Epoch 44, Loss: 0.031568750739097595, Acc: 99.2061538696289, Test Loss: 0.027952855452895164, Test Acc: 99.3276596069336
Epoch 45, Loss: 0.03138209134340286, Acc: 99.21653747558594, Test Loss: 0.028702586889266968, Test Acc: 99.28298950195312
Epoch 46, Loss: 0.030948787927627563, Acc: 99.2111587524414, Test Loss: 0.027201848104596138, Test Acc: 99.3801498413086
Epoch 47, Loss: 0.03088829480111599, Acc: 99.22423553466797, Test Loss: 0.027017828077077866, Test Acc: 99.3622817993164
Epoch 48, Loss: 0.03084060549736023, Acc: 99.20807647705078, Test Loss: 0.027105113491415977, Test Acc: 99.36339569091797
Epoch 49, Loss: 0.03026285581290722, Acc: 99.22500610351562, Test Loss: 0.028903553262352943, Test Acc: 99.27851867675781
Epoch 50, Loss: 0.03028479404747486, Acc: 99.22115325927734, Test Loss: 0.02647838369011879, Test Acc: 99.37791442871094

Process finished with exit code 137 (interrupted by signal 9: SIGKILL)
