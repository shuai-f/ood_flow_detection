/Users/shuaif/miniforge3/envs/py38/bin/python /Users/shuaif/PycharmProjects/ood_flow_detection/contrast_learning/main_ce_baseline.py --epoch 50 --model GRU --batch_size 128 --n_data_train 260000 --activation relu
Namespace(activation='relu', batch_size=128, data='moore', draw_figures=False, epoch=50, lr=0.0001, model='GRU', n_data_train=260000, projection_dim=128, write_summary=False)
Loading moore data...
(268611, 256) (89538, 256)
Training dataset shapes after slicing:
(260000, 256, 1) (260000,)
/Users/shuaif/miniforge3/envs/py38/lib/python3.8/site-packages/keras/backend.py:5585: UserWarning: "`sparse_categorical_crossentropy` received `from_logits=True`, but the `output` argument was produced by a Softmax activation and thus does not represent logits. Was this intended?
  output, from_logits = _get_logits(
2023-03-16 20:03:29.528924: W tensorflow/tsl/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz
Epoch 1, Loss: 0.5319137573242188, Acc: 88.75846099853516, Test Loss: 0.2880024015903473, Test Acc: 92.05699920654297
Epoch 2, Loss: 0.24022774398326874, Acc: 93.34307861328125, Test Loss: 0.20808197557926178, Test Acc: 94.28511047363281
Epoch 3, Loss: 0.18682150542736053, Acc: 94.73692321777344, Test Loss: 0.16383405029773712, Test Acc: 95.74482727050781
Epoch 4, Loss: 0.15665344893932343, Acc: 95.85845947265625, Test Loss: 0.14957605302333832, Test Acc: 96.08880615234375
Epoch 5, Loss: 0.13544298708438873, Acc: 96.32115173339844, Test Loss: 0.12657931447029114, Test Acc: 96.44508361816406
Epoch 6, Loss: 0.12095761299133301, Acc: 96.64461517333984, Test Loss: 0.11899898201227188, Test Acc: 96.82257843017578
Epoch 7, Loss: 0.10906057804822922, Acc: 96.9876937866211, Test Loss: 0.10252732783555984, Test Acc: 96.94766235351562
Epoch 8, Loss: 0.10171280056238174, Acc: 97.19038391113281, Test Loss: 0.09810495376586914, Test Acc: 97.47816467285156
Epoch 9, Loss: 0.09364403784275055, Acc: 97.4107666015625, Test Loss: 0.09565265476703644, Test Acc: 97.38993835449219
Epoch 10, Loss: 0.08767061680555344, Acc: 97.54499816894531, Test Loss: 0.08878832310438156, Test Acc: 97.52172088623047
Epoch 11, Loss: 0.08246956765651703, Acc: 97.67691802978516, Test Loss: 0.08120501041412354, Test Acc: 97.6579818725586
Epoch 12, Loss: 0.07779869437217712, Acc: 97.79808044433594, Test Loss: 0.08662243187427521, Test Acc: 97.3363265991211
Epoch 13, Loss: 0.0733037069439888, Acc: 97.88076782226562, Test Loss: 0.06509944051504135, Test Acc: 98.24990844726562
Epoch 14, Loss: 0.06931524723768234, Acc: 98.01692199707031, Test Loss: 0.07145184278488159, Test Acc: 97.83890533447266
Epoch 15, Loss: 0.06554912775754929, Acc: 98.13076782226562, Test Loss: 0.06053635850548744, Test Acc: 98.29122924804688
Epoch 16, Loss: 0.06319496780633926, Acc: 98.2342300415039, Test Loss: 0.05860788747668266, Test Acc: 98.4129638671875
Epoch 17, Loss: 0.061675187200307846, Acc: 98.25999450683594, Test Loss: 0.058739788830280304, Test Acc: 98.35712432861328
Epoch 18, Loss: 0.05855593457818031, Acc: 98.35730743408203, Test Loss: 0.0581025630235672, Test Acc: 98.4040298461914
Epoch 19, Loss: 0.05592721328139305, Acc: 98.4669189453125, Test Loss: 0.057868435978889465, Test Acc: 98.50566101074219
Epoch 20, Loss: 0.05454886704683304, Acc: 98.51192474365234, Test Loss: 0.05348839983344078, Test Acc: 98.59165954589844
Epoch 21, Loss: 0.052431609481573105, Acc: 98.57846069335938, Test Loss: 0.04756684601306915, Test Acc: 98.77816772460938
Epoch 22, Loss: 0.05058052018284798, Acc: 98.63500213623047, Test Loss: 0.048506610095500946, Test Acc: 98.72010040283203
Epoch 23, Loss: 0.050134483724832535, Acc: 98.6203842163086, Test Loss: 0.04826086759567261, Test Acc: 98.74913787841797
Epoch 24, Loss: 0.048208195716142654, Acc: 98.69038391113281, Test Loss: 0.04976356029510498, Test Acc: 98.69440460205078
Epoch 25, Loss: 0.04657349735498428, Acc: 98.7580795288086, Test Loss: 0.045105114579200745, Test Acc: 98.80162811279297
Epoch 26, Loss: 0.0452289804816246, Acc: 98.7657699584961, Test Loss: 0.043946970254182816, Test Acc: 98.9054946899414
Epoch 27, Loss: 0.04446570202708244, Acc: 98.8107681274414, Test Loss: 0.04133860021829605, Test Acc: 98.96022033691406
Epoch 28, Loss: 0.042997632175683975, Acc: 98.84076690673828, Test Loss: 0.04393867775797844, Test Acc: 98.8485336303711
Epoch 29, Loss: 0.042190395295619965, Acc: 98.846923828125, Test Loss: 0.05162576586008072, Test Acc: 98.62405395507812
Epoch 30, Loss: 0.04140837863087654, Acc: 98.89653778076172, Test Loss: 0.06124472990632057, Test Acc: 98.36717224121094
Epoch 31, Loss: 0.04062370955944061, Acc: 98.91230773925781, Test Loss: 0.040503181517124176, Test Acc: 98.99260711669922
Epoch 32, Loss: 0.03956444561481476, Acc: 98.94884490966797, Test Loss: 0.041555650532245636, Test Acc: 98.91889953613281
Epoch 33, Loss: 0.03890727832913399, Acc: 98.95846557617188, Test Loss: 0.04859759286046028, Test Acc: 98.62293243408203
Epoch 34, Loss: 0.03786452114582062, Acc: 98.98922729492188, Test Loss: 0.04281993582844734, Test Acc: 98.92001342773438
Epoch 35, Loss: 0.03734702244400978, Acc: 98.98615264892578, Test Loss: 0.03767387196421623, Test Acc: 99.06407928466797
Epoch 36, Loss: 0.037440765649080276, Acc: 98.99884796142578, Test Loss: 0.0375913605093956, Test Acc: 99.05738067626953
Epoch 37, Loss: 0.035946011543273926, Acc: 99.05192565917969, Test Loss: 0.03674449771642685, Test Acc: 99.05514526367188
Epoch 38, Loss: 0.035248029977083206, Acc: 99.07154083251953, Test Loss: 0.037261705845594406, Test Acc: 99.08306884765625
Epoch 39, Loss: 0.03491954132914543, Acc: 99.06346130371094, Test Loss: 0.03634967654943466, Test Acc: 99.05514526367188
Epoch 40, Loss: 0.03423662111163139, Acc: 99.09346008300781, Test Loss: 0.034494221210479736, Test Acc: 99.17911529541016
Epoch 41, Loss: 0.033710431307554245, Acc: 99.09615325927734, Test Loss: 0.037448056042194366, Test Acc: 99.04063415527344
Epoch 42, Loss: 0.033691033720970154, Acc: 99.1019287109375, Test Loss: 0.03811868280172348, Test Acc: 98.94905090332031
Epoch 43, Loss: 0.0324605293571949, Acc: 99.13884735107422, Test Loss: 0.03540768846869469, Test Acc: 99.13109588623047
Epoch 44, Loss: 0.032267823815345764, Acc: 99.1526870727539, Test Loss: 0.033736467361450195, Test Acc: 99.18917083740234
Epoch 45, Loss: 0.03223957121372223, Acc: 99.15731048583984, Test Loss: 0.03696737438440323, Test Acc: 99.05626678466797
Epoch 46, Loss: 0.03192894160747528, Acc: 99.1580810546875, Test Loss: 0.03835683688521385, Test Acc: 99.02611541748047
Epoch 47, Loss: 0.031093504279851913, Acc: 99.19384765625, Test Loss: 0.036270227283239365, Test Acc: 99.09759521484375
Epoch 48, Loss: 0.0300207007676363, Acc: 99.21192169189453, Test Loss: 0.031170036643743515, Test Acc: 99.2528305053711
Epoch 49, Loss: 0.030149100348353386, Acc: 99.21307373046875, Test Loss: 0.033957645297050476, Test Acc: 99.16571807861328
Epoch 50, Loss: 0.02960800565779209, Acc: 99.22999572753906, Test Loss: 0.03261915594339371, Test Acc: 99.19587707519531